<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#10b981">
    <meta name="description" content="Track your daily health habits - water, sleep, exercise, meals, and mood">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Health Tracker">
    
    <title>Daily Health Tracker</title>
    
    <link rel="manifest" href="manifest.json">
    <!-- Icon links removed as requested -->
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        * {
            -webkit-tap-highlight-color: transparent;
        }
        body {
            overscroll-behavior: none;
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;
        
        // Icons components
        const Calendar = () => (
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                <line x1="16" y1="2" x2="16" y2="6"></line>
                <line x1="8" y1="2" x2="8" y2="6"></line>
                <line x1="3" y1="10" x2="21" y2="10"></line>
            </svg>
        );
        
        const Droplet = ({ size = 18, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"></path>
            </svg>
        );
        
        const Moon = ({ size = 18, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
            </svg>
        );
        
        const Activity = ({ size = 18, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
            </svg>
        );
        
        const Plus = ({ size = 20 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
            </svg>
        );
        
        const Trash2 = ({ size = 18 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <polyline points="3 6 5 6 21 6"></polyline>
                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                <line x1="10" y1="11" x2="10" y2="17"></line>
                <line x1="14" y1="11" x2="14" y2="17"></line>
            </svg>
        );
        
        const Smile = ({ size = 18, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <circle cx="12" cy="12" r="10"></circle>
                <path d="M8 14s1.5 2 4 2 4-2 4-2"></path>
                <line x1="9" y1="9" x2="9.01" y2="9"></line>
                <line x1="15" y1="9" x2="15.01" y2="9"></line>
            </svg>
        );
        
        const Utensils = ({ size = 18, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2"></path>
                <path d="M7 2v20"></path>
                <path d="M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7"></path>
            </svg>
        );
        
        const TrendingUp = ({ className = "" }) => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline>
                <polyline points="17 6 23 6 23 12"></polyline>
            </svg>
        );
        
        const Download = ({ size = 20 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                <polyline points="7 10 12 15 17 10"></polyline>
                <line x1="12" y1="15" x2="12" y2="3"></line>
            </svg>
        );

        function HealthTracker() {
          const [entries, setEntries] = useState([]);
          const [activeTab, setActiveTab] = useState('add');
          const [showInstall, setShowInstall] = useState(false);
          const [deferredPrompt, setDeferredPrompt] = useState(null);
          const [currentEntry, setCurrentEntry] = useState({
            date: new Date().toISOString().split('T')[0],
            water: 0,
            sleep: 0,
            exercise: 0,
            mood: 'neutral',
            meals: '',
            notes: ''
          });

          useEffect(() => {
            loadEntries();
            
            // Register service worker - FIXED PATH HERE (./sw.js)
            if ('serviceWorker' in navigator) {
              navigator.serviceWorker.register('./sw.js')
                .then(reg => console.log('Service Worker registered'))
                .catch(err => console.log('Service Worker registration failed'));
            }
            
            // Handle install prompt
            window.addEventListener('beforeinstallprompt', (e) => {
              e.preventDefault();
              setDeferredPrompt(e);
              setShowInstall(true);
            });
          }, []);

          const handleInstallClick = async () => {
            if (!deferredPrompt) return;
            
            deferredPrompt.prompt();
            const { outcome } = await deferredPrompt.userChoice;
            
            if (outcome === 'accepted') {
              setShowInstall(false);
            }
            setDeferredPrompt(null);
          };

          const loadEntries = () => {
            try {
              const saved = localStorage.getItem('healthEntries');
              if (saved) {
                const parsed = JSON.parse(saved);
                setEntries(parsed.sort((a, b) => new Date(b.date) - new Date(a.date)));
              }
            } catch (error) {
              console.log('No previous entries found');
            }
          };

          const saveEntries = (newEntries) => {
            try {
              localStorage.setItem('healthEntries', JSON.stringify(newEntries));
            } catch (error) {
              console.error('Failed to save entries:', error);
            }
          };

          const handleSubmit = (e) => {
            e.preventDefault();
            
            const newEntry = {
              ...currentEntry,
              id: Date.now().toString()
            };

            const updatedEntries = [newEntry, ...entries];
            setEntries(updatedEntries);
            saveEntries(updatedEntries);
            
            setCurrentEntry({
              date: new Date().toISOString().split('T')[0],
              water: 0,
              sleep: 0,
              exercise: 0,
              mood: 'neutral',
              meals: '',
              notes: ''
            });
          };

          const deleteEntry = (id) => {
            const updatedEntries = entries.filter(e => e.id !== id);
            setEntries(updatedEntries);
            saveEntries(updatedEntries);
          };

          const getWeeklySummary = () => {
            const oneWeekAgo = new Date();
            oneWeekAgo.setDate(oneWeekAgo.getDate() - 7);
            
            const weekEntries = entries.filter(e => new Date(e.date) >= oneWeekAgo);
            
            if (weekEntries.length === 0) return null;
            
            const totals = weekEntries.reduce((acc, entry) => ({
              water: acc.water + (entry.water || 0),
              sleep: acc.sleep + (entry.sleep || 0),
              exercise: acc.exercise + (entry.exercise || 0)
            }), { water: 0, sleep: 0, exercise: 0 });
            
            const count = weekEntries.length;
            
            return {
              avgWater: (totals.water / count).toFixed(1),
              avgSleep: (totals.sleep / count).toFixed(1),
              avgExercise: (totals.exercise / count).toFixed(0),
              daysTracked: count
            };
          };

          const moodEmojis = {
            great: 'üòÑ',
            good: 'üôÇ',
            neutral: 'üòê',
            bad: 'üòï',
            terrible: 'üòû'
          };

          const summary = getWeeklySummary();

          return (
            <div className="min-h-screen bg-gradient-to-br from-blue-50 to-green-50 p-4 md:p-6">
              <div className="max-w-4xl mx-auto">
                {showInstall && (
                  <div className="bg-green-500 text-white p-4 rounded-lg mb-4 flex items-center justify-between">
                    <span className="text-sm">Install app for quick access</span>
                    <button
                      onClick={handleInstallClick}
                      className="bg-white text-green-600 px-4 py-2 rounded-lg font-semibold text-sm flex items-center gap-2"
                    >
                      <Download size={16} />
                      Install
                    </button>
                  </div>
                )}
                
                <div className="bg-white rounded-2xl shadow-xl p-6 md:p-8 mb-6">
                  <h1 className="text-2xl md:text-3xl font-bold text-gray-800 mb-2 flex items-center gap-2">
                    <Activity className="text-green-500" />
                    Daily Health Tracker
                  </h1>
                  <p className="text-gray-600 mb-6 text-sm md:text-base">Track your daily wellness habits</p>

                  <div className="flex gap-1 md:gap-2 mb-6 border-b border-gray-200 overflow-x-auto">
                    <button
                      onClick={() => setActiveTab('add')}
                      className={`px-3 md:px-4 py-2 font-medium transition text-sm md:text-base whitespace-nowrap ${
                        activeTab === 'add'
                          ? 'text-green-600 border-b-2 border-green-600'
                          : 'text-gray-500 hover:text-gray-700'
                      }`}
                    >
                      Add Entry
                    </button>
                    <button
                      onClick={() => setActiveTab('history')}
                      className={`px-3 md:px-4 py-2 font-medium transition text-sm md:text-base whitespace-nowrap ${
                        activeTab === 'history'
                          ? 'text-green-600 border-b-2 border-green-600'
                          : 'text-gray-500 hover:text-gray-700'
                      }`}
                    >
                      History
                    </button>
                    <button
                      onClick={() => setActiveTab('summary')}
                      className={`px-3 md:px-4 py-2 font-medium transition text-sm md:text-base whitespace-nowrap ${
                        activeTab === 'summary'
                          ? 'text-green-600 border-b-2 border-green-600'
                          : 'text-gray-500 hover:text-gray-700'
                      }`}
                    >
                      Summary
                    </button>
                  </div>

                  {activeTab === 'add' && (
                    <div className="space-y-4 md:space-y-6">
                      <div>
                        <label className="flex items-center gap-2 text-sm font-medium text-gray-700 mb-2">
                          <Calendar />
                          Date
                        </label>
                        <input
                          type="date"
                          value={currentEntry.date}
                          onChange={(e) => setCurrentEntry({...currentEntry, date: e.target.value})}
                          className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-base"
                          required
                        />
                      </div>

                      <div>
                        <label className="flex items-center gap-2 text-sm font-medium text-gray-700 mb-2">
                          <Smile className="text-yellow-500" />
                          How are you feeling?
                        </label>
                        <div className="grid grid-cols-5 gap-2">
                          {Object.entries(moodEmojis).map(([mood, emoji]) => (
                            <button
                              key={mood}
                              type="button"
                              onClick={() => setCurrentEntry({...currentEntry, mood})}
                              className={`py-3 rounded-lg border-2 transition text-2xl ${
                                currentEntry.mood === mood
                                  ? 'border-green-500 bg-green-50'
                                  : 'border-gray-200 hover:border-gray-300 active:bg-gray-50'
                              }`}
                            >
                              {emoji}
                            </button>
                          ))}
                        </div>
                      </div>

                      <div>
                        <label className="flex items-center gap-2 text-sm font-medium text-gray-700 mb-2">
                          <Droplet className="text-blue-500" />
                          Water Intake (glasses)
                        </label>
                        <input
                          type="number"
                          min="0"
                          value={currentEntry.water}
                          onChange={(e) => setCurrentEntry({...currentEntry, water: parseInt(e.target.value) || 0})}
                          className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-base"
                          placeholder="e.g., 8"
                        />
                      </div>

                      <div>
                        <label className="flex items-center gap-2 text-sm font-medium text-gray-700 mb-2">
                          <Moon className="text-indigo-500" />
                          Sleep (hours)
                        </label>
                        <input
                          type="number"
                          min="0"
                          max="24"
                          step="0.5"
                          value={currentEntry.sleep}
                          onChange={(e) => setCurrentEntry({...currentEntry, sleep: parseFloat(e.target.value) || 0})}
                          className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-base"
                          placeholder="e.g., 7.5"
                        />
                      </div>

                      <div>
                        <label className="flex items-center gap-2 text-sm font-medium text-gray-700 mb-2">
                          <Activity className="text-green-500" />
                          Exercise (minutes)
                        </label>
                        <input
                          type="number"
                          min="0"
                          value={currentEntry.exercise}
                          onChange={(e) => setCurrentEntry({...currentEntry, exercise: parseInt(e.target.value) || 0})}
                          className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-base"
                          placeholder="e.g., 30"
                        />
                      </div>

                      <div>
                        <label className="flex items-center gap-2 text-sm font-medium text-gray-700 mb-2">
                          <Utensils className="text-orange-500" />
                          Meals
                        </label>
                        <textarea
                          value={currentEntry.meals}
                          onChange={(e) => setCurrentEntry({...currentEntry, meals: e.target.value})}
                          className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-base"
                          rows="3"
                          placeholder="What did you eat today?"
                        />
                      </div>

                      <div>
                        <label className="text-sm font-medium text-gray-700 mb-2 block">
                          Additional Notes
                        </label>
                        <textarea
                          value={currentEntry.notes}
                          onChange={(e) => setCurrentEntry({...currentEntry, notes: e.target.value})}
                          className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-base"
                          rows="2"
                          placeholder="Any other observations?"
                        />
                      </div>

                      <button
                        onClick={handleSubmit}
                        className="w-full bg-green-500 hover:bg-green-600 active:bg-green-700 text-white font-semibold py-4 px-6 rounded-lg transition flex items-center justify-center gap-2 text-base"
                      >
                        <Plus />
                        Add Entry
                      </button>
                    </div>
                  )}

                  {activeTab === 'history' && (
                    <div>
                      {entries.length === 0 ? (
                        <p className="text-gray-500 text-center py-8">No entries yet. Add your first entry!</p>
                      ) : (
                        <div className="space-y-4">
                          {entries.map((entry) => (
                            <div key={entry.id} className="border border-gray-200 rounded-lg p-4 hover:shadow-md transition active:bg-gray-50">
                              <div className="flex justify-between items-start mb-3">
                                <div>
                                  <span className="font-semibold text-gray-800 block">{entry.date}</span>
                                  <span className="text-2xl">{moodEmojis[entry.mood]}</span>
                                </div>
                                <button
                                  onClick={() => deleteEntry(entry.id)}
                                  className="text-red-500 hover:text-red-700 active:text-red-800 p-2"
                                >
                                  <Trash2 />
                                </button>
                              </div>
                              
                              <div className="grid grid-cols-3 gap-3 mb-3">
                                <div className="flex items-center gap-2 text-sm">
                                  <Droplet size={16} className="text-blue-500" />
                                  <span>{entry.water}</span>
                                </div>
                                <div className="flex items-center gap-2 text-sm">
                                  <Moon size={16} className="text-indigo-500" />
                                  <span>{entry.sleep}h</span>
                                </div>
                                <div className="flex items-center gap-2 text-sm">
                                  <Activity size={16} className="text-green-500" />
                                  <span>{entry.exercise}m</span>
                                </div>
                              </div>

                              {entry.meals && (
                                <div className="mb-2">
                                  <div className="flex items-center gap-2 text-xs font-medium text-gray-700 mb-1">
                                    <Utensils size={14} className="text-orange-500" />
                                    Meals
                                  </div>
                                  <p className="text-sm text-gray-600 pl-5">{entry.meals}</p>
                                </div>
                              )}
                              
                              {entry.notes && (
                                <p className="text-sm text-gray-600 italic pl-5">{entry.notes}</p>
                              )}
                            </div>
                          ))}
                        </div>
                      )}
                    </div>
                  )}

                  {activeTab === 'summary' && (
                    <div>
                      {summary ? (
                        <div className="space-y-6">
                          <div className="flex items-center gap-2 text-lg font-semibold text-gray-800 mb-4">
                            <TrendingUp className="text-green-500" />
                            Last 7 Days
                          </div>

                          <div className="grid grid-cols-2 gap-3 md:gap-4">
                            <div className="bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg p-4">
                              <Droplet size={24} className="text-blue-500 mb-2" />
                              <div className="text-2xl font-bold text-gray-800">{summary.avgWater}</div>
                              <div className="text-xs md:text-sm text-gray-600">Avg Water/Day</div>
                            </div>

                            <div className="bg-gradient-to-br from-indigo-50 to-indigo-100 rounded-lg p-4">
                              <Moon size={24} className="text-indigo-500 mb-2" />
                              <div className="text-2xl font-bold text-gray-800">{summary.avgSleep}h</div>
                              <div className="text-xs md:text-sm text-gray-600">Avg Sleep</div>
                            </div>

                            <div className="bg-gradient-to-br from-green-50 to-green-100 rounded-lg p-4">
                              <Activity size={24} className="text-green-500 mb-2" />
                              <div className="text-2xl font-bold text-gray-800">{summary.avgExercise}</div>
                              <div className="text-xs md:text-sm text-gray-600">Avg Exercise</div>
                            </div>

                            <div className="bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg p-4">
                              <Calendar />
                              <div className="text-2xl font-bold text-gray-800 mt-2">{summary.daysTracked}</div>
                              <div className="text-xs md:text-sm text-gray-600">Days Tracked</div>
                            </div>
                          </div>

                          <div className="bg-green-50 border border-green-200 rounded-lg p-4">
                            <h3 className="font-semibold text-green-800 mb-2">Keep it up!</h3>
                            <p className="text-sm text-green-700">
                              You've tracked {summary.daysTracked} days this week. Consistency is key!
                            </p>
                          </div>
                        </div>
                      ) : (
                        <p className="text-gray-500 text-center py-8">
                          No data yet. Start tracking!
                        </p>
                      )}
                    </div>
                  )}
                </div>
              </div>
            </div>
          );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<HealthTracker />);
    </script>
</body>
</html>
