<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#f8fafc">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Health</title>
    
    <link rel="manifest" href="manifest.json">
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        brand: { 500: '#3b82f6', 600: '#2563eb' },
                        accent: { 500: '#8b5cf6', 600: '#7c3aed' },
                        success: { 500: '#10b981', 600: '#059669' }
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                    animation: {
                        'slide-up': 'slideUp 0.4s ease-out',
                        'fade-in': 'fadeIn 0.3s ease-out',
                        'bounce-slight': 'bounceSlight 0.3s ease-in-out',
                    },
                    keyframes: {
                        slideUp: {
                            '0%': { transform: 'translateY(20px)', opacity: '0' },
                            '100%': { transform: 'translateY(0)', opacity: '1' },
                        },
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' },
                        }
                    }
                }
            }
        }
    </script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');
        
        * { -webkit-tap-highlight-color: transparent; font-family: 'Inter', sans-serif; }
        body { background-color: #f8fafc; overscroll-behavior-y: none; }
        
        /* Hide Scrollbar */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        /* Glassmorphism */
        .glass-nav {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border-top: 1px solid rgba(255,255,255,0.5);
        }
        
        .card-shadow { box-shadow: 0 10px 40px -10px rgba(0,0,0,0.05); }
    </style>
</head>
<body class="text-slate-800 selection:bg-brand-500 selection:text-white">
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- ICONS ---
        const Icons = {
            Home: ({active}) => <svg className={`w-6 h-6 ${active ? 'fill-brand-600' : 'text-slate-400'}`} viewBox="0 0 24 24" stroke="currentColor" strokeWidth={active?0:2} fill="none"><path d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/></svg>,
            History: ({active}) => <svg className={`w-6 h-6 ${active ? 'fill-brand-600' : 'text-slate-400'}`} viewBox="0 0 24 24" stroke="currentColor" strokeWidth={active?0:2} fill="none"><path strokeLinecap="round" strokeLinejoin="round" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>,
            Chart: ({active}) => <svg className={`w-6 h-6 ${active ? 'fill-brand-600' : 'text-slate-400'}`} viewBox="0 0 24 24" stroke="currentColor" strokeWidth={active?0:2} fill="none"><path strokeLinecap="round" strokeLinejoin="round" d="M16 8v8m-4-5v5m-4-2v2m-2 4h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" /></svg>,
            Water: () => <svg className="w-5 h-5 text-blue-500" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z" /></svg>,
            Moon: () => <svg className="w-5 h-5 text-indigo-500" viewBox="0 0 24 24" fill="currentColor"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" /></svg>,
            Zap: () => <svg className="w-5 h-5 text-emerald-500" viewBox="0 0 24 24" fill="currentColor"><path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z" /></svg>,
            Trash: () => <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth="2"><path strokeLinecap="round" strokeLinejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" /></svg>
        };

        // --- COMPONENTS ---
        const Card = ({ children, className = "" }) => (
            <div className={`bg-white rounded-3xl p-6 card-shadow border border-slate-50 animate-slide-up ${className}`}>
                {children}
            </div>
        );

        const StatRing = ({ label, value, max, color, icon: Icon }) => {
            const pct = Math.min((value / max) * 100, 100);
            const r = 30;
            const c = 2 * Math.PI * r;
            const offset = c - (pct / 100) * c;
            
            return (
                <div className="flex flex-col items-center">
                    <div className="relative w-20 h-20 flex items-center justify-center">
                        <svg className="transform -rotate-90 w-20 h-20">
                            <circle cx="40" cy="40" r={r} stroke="currentColor" strokeWidth="6" fill="transparent" className="text-slate-100" />
                            <circle cx="40" cy="40" r={r} stroke="currentColor" strokeWidth="6" fill="transparent" strokeDasharray={c} strokeDashoffset={offset} strokeLinecap="round" className={`transition-all duration-1000 ${color}`} />
                        </svg>
                        <div className="absolute inset-0 flex items-center justify-center">
                            <Icon />
                        </div>
                    </div>
                    <span className="mt-2 font-bold text-slate-800">{value}</span>
                    <span className="text-[10px] uppercase font-bold text-slate-400 tracking-wider">{label}</span>
                </div>
            );
        };

        function HealthTracker() {
            const [activeTab, setActiveTab] = useState('add');
            const [entries, setEntries] = useState([]);
            const [currentEntry, setCurrentEntry] = useState({
                date: new Date().toISOString().split('T')[0],
                water: 0, sleep: 0, exercise: 0, mood: 'neutral', meals: '', notes: ''
            });

            useEffect(() => {
                const saved = localStorage.getItem('healthEntries');
                if (saved) setEntries(JSON.parse(saved).sort((a, b) => new Date(b.date) - new Date(a.date)));
                if ('serviceWorker' in navigator) navigator.serviceWorker.register('./sw.js');
            }, []);

            const saveEntry = () => {
                const newEntries = [{ ...currentEntry, id: Date.now().toString() }, ...entries];
                setEntries(newEntries);
                localStorage.setItem('healthEntries', JSON.stringify(newEntries));
                setCurrentEntry(prev => ({ ...prev, water: 0, sleep: 0, exercise: 0, meals: '', notes: '' }));
                alert("Entry Saved!");
            };

            const moods = [
                { id: 'terrible', emoji: 'ðŸ˜£', label: 'Bad' },
                { id: 'neutral', emoji: 'ðŸ˜', label: 'Okay' },
                { id: 'good', emoji: 'ðŸ™‚', label: 'Good' },
                { id: 'great', emoji: 'ðŸ¤©', label: 'Great' }
            ];

            const getStats = () => {
                const recent = entries.slice(0, 7);
                if (!recent.length) return null;
                const sums = recent.reduce((acc, curr) => ({
                    w: acc.w + (curr.water || 0),
                    s: acc.s + (curr.sleep || 0),
                    e: acc.e + (curr.exercise || 0)
                }), { w: 0, s: 0, e: 0 });
                return {
                    water: (sums.w / recent.length).toFixed(1),
                    sleep: (sums.s / recent.length).toFixed(1),
                    exercise: (sums.e / recent.length).toFixed(0),
                    count: recent.length
                };
            };
            const stats = getStats();

            return (
                <div className="min-h-screen pb-24 bg-gradient-to-br from-slate-50 to-blue-50/30">
                    
                    {/* Header */}
                    <div className="px-6 pt-12 pb-6 flex justify-between items-end">
                        <div>
                            <div className="text-xs font-bold text-slate-400 uppercase tracking-widest mb-1">{new Date().toLocaleDateString('en-US', {weekday:'long', month:'short', day:'numeric'})}</div>
                            <h1 className="text-3xl font-extrabold text-slate-900">Health Tracker</h1>
                        </div>
                        <div className="w-10 h-10 rounded-full bg-slate-200 border-2 border-white shadow-sm overflow-hidden">
                             <img src={`https://api.dicebear.com/7.x/thumbs/svg?seed=Felix`} alt="avatar" />
                        </div>
                    </div>

                    <div className="px-5 space-y-6 max-w-md mx-auto">
                        
                        {/* --- ADD ENTRY --- */}
                        {activeTab === 'add' && (
                            <div className="space-y-5">
                                {/* Date & Mood */}
                                <Card>
                                    <input type="date" value={currentEntry.date} onChange={e=>setCurrentEntry({...currentEntry, date:e.target.value})} className="w-full bg-slate-50 rounded-xl px-4 py-3 font-semibold text-slate-700 outline-none mb-6" />
                                    
                                    <div className="flex justify-between gap-2">
                                        {moods.map(m => (
                                            <button key={m.id} onClick={()=>setCurrentEntry({...currentEntry, mood: m.id})} 
                                                className={`flex-1 py-3 rounded-2xl text-2xl transition-all ${currentEntry.mood === m.id ? 'bg-slate-900 shadow-lg scale-110' : 'bg-slate-50 grayscale opacity-70'}`}>
                                                {m.emoji}
                                            </button>
                                        ))}
                                    </div>
                                </Card>

                                {/* Metrics */}
                                <div className="grid grid-cols-2 gap-4">
                                    <Card>
                                        <div className="flex justify-between items-start mb-2">
                                            <span className="text-xs font-bold text-slate-400 uppercase">Water</span>
                                            <Icons.Water />
                                        </div>
                                        <div className="text-3xl font-extrabold text-slate-800 mb-4">{currentEntry.water} <span className="text-sm font-medium text-slate-400">gls</span></div>
                                        <div className="flex gap-2">
                                            <button onClick={()=>setCurrentEntry(c=>({...c, water: Math.max(0, c.water-1)}))} className="w-8 h-8 rounded-full bg-slate-100 flex items-center justify-center font-bold text-slate-500">-</button>
                                            <button onClick={()=>setCurrentEntry(c=>({...c, water: c.water+1}))} className="w-8 h-8 rounded-full bg-blue-500 text-white shadow-lg shadow-blue-500/30 flex items-center justify-center font-bold">+</button>
                                        </div>
                                    </Card>

                                    <Card>
                                        <div className="flex justify-between items-start mb-2">
                                            <span className="text-xs font-bold text-slate-400 uppercase">Sleep</span>
                                            <Icons.Moon />
                                        </div>
                                        <div className="text-3xl font-extrabold text-slate-800 mb-4">{currentEntry.sleep} <span className="text-sm font-medium text-slate-400">hr</span></div>
                                        <div className="flex gap-2">
                                            <button onClick={()=>setCurrentEntry(c=>({...c, sleep: Math.max(0, c.sleep-0.5)}))} className="w-8 h-8 rounded-full bg-slate-100 flex items-center justify-center font-bold text-slate-500">-</button>
                                            <button onClick={()=>setCurrentEntry(c=>({...c, sleep: c.sleep+0.5}))} className="w-8 h-8 rounded-full bg-indigo-500 text-white shadow-lg shadow-indigo-500/30 flex items-center justify-center font-bold">+</button>
                                        </div>
                                    </Card>
                                </div>

                                <Card>
                                    <div className="flex justify-between items-center mb-4">
                                        <span className="text-xs font-bold text-slate-400 uppercase">Exercise ({currentEntry.exercise} min)</span>
                                        <Icons.Zap />
                                    </div>
                                    <input type="range" min="0" max="180" step="10" value={currentEntry.exercise} onChange={e=>setCurrentEntry({...currentEntry, exercise: parseInt(e.target.value)})} 
                                        className="w-full h-2 bg-slate-100 rounded-lg appearance-none cursor-pointer accent-emerald-500" />
                                </Card>

                                <Card>
                                    <input type="text" placeholder="What did you eat?" value={currentEntry.meals} onChange={e=>setCurrentEntry({...currentEntry, meals:e.target.value})} className="w-full py-2 border-b border-slate-100 outline-none placeholder-slate-400 text-slate-700 mb-2" />
                                    <input type="text" placeholder="Notes..." value={currentEntry.notes} onChange={e=>setCurrentEntry({...currentEntry, notes:e.target.value})} className="w-full py-2 border-b border-slate-100 outline-none placeholder-slate-400 text-slate-700" />
                                </Card>

                                <button onClick={saveEntry} className="w-full py-4 bg-slate-900 text-white rounded-3xl font-bold shadow-xl shadow-slate-900/20 active:scale-95 transition-transform">
                                    Save Entry
                                </button>
                            </div>
                        )}

                        {/* --- HISTORY --- */}
                        {activeTab === 'history' && (
                            <div className="space-y-4">
                                {entries.map(e => (
                                    <div key={e.id} className="bg-white rounded-2xl p-4 border border-slate-100 shadow-sm flex justify-between items-center animate-slide-up">
                                        <div className="flex items-center gap-4">
                                            <div className="text-2xl">{moods.find(m=>m.id===e.mood)?.emoji}</div>
                                            <div>
                                                <div className="font-bold text-slate-800">{e.date}</div>
                                                <div className="text-xs text-slate-400 font-medium mt-0.5">
                                                    ðŸ’§ {e.water} â€¢ ðŸŒ™ {e.sleep}h â€¢ âš¡ {e.exercise}m
                                                </div>
                                            </div>
                                        </div>
                                        <button onClick={()=>{setEntries(entries.filter(x=>x.id!==e.id)); localStorage.setItem('healthEntries', JSON.stringify(entries.filter(x=>x.id!==e.id)))}} className="text-slate-300 hover:text-red-500">
                                            <Icons.Trash />
                                        </button>
                                    </div>
                                ))}
                                {entries.length === 0 && <div className="text-center text-slate-400 py-10">No history yet</div>}
                            </div>
                        )}

                        {/* --- SUMMARY --- */}
                        {activeTab === 'summary' && (
                            <div className="space-y-6">
                                {stats ? (
                                    <>
                                        <Card className="flex justify-between py-8">
                                            <StatRing label="Water" value={stats.water} max={8} color="text-blue-500" icon={Icons.Water} />
                                            <StatRing label="Sleep" value={stats.sleep} max={8} color="text-indigo-500" icon={Icons.Moon} />
                                            <StatRing label="Activity" value={stats.exercise} max={60} color="text-emerald-500" icon={Icons.Zap} />
                                        </Card>
                                        <div className="bg-slate-900 rounded-3xl p-6 text-white shadow-xl shadow-slate-900/20">
                                            <div className="text-slate-400 text-xs font-bold uppercase tracking-widest mb-1">Total Tracked</div>
                                            <div className="text-4xl font-extrabold">{stats.count} <span className="text-lg font-medium text-slate-500">days</span></div>
                                            <div className="mt-4 text-sm text-slate-300 leading-relaxed">
                                                Great job! Consistency is the key to healthy habits. Keep going!
                                            </div>
                                        </div>
                                    </>
                                ) : <div className="text-center text-slate-400 py-10">Add more data to see stats</div>}
                            </div>
                        )}
                    </div>

                    {/* Bottom Dock Navigation */}
                    <div className="fixed bottom-0 w-full glass-nav pb-safe pt-2 px-6 pb-6">
                        <div className="flex justify-around items-center max-w-md mx-auto">
                            <button onClick={()=>setActiveTab('add')} className={`p-4 rounded-2xl transition-all ${activeTab==='add' ? 'bg-blue-50' : ''}`}><Icons.Home active={activeTab==='add'}/></button>
                            <button onClick={()=>setActiveTab('history')} className={`p-4 rounded-2xl transition-all ${activeTab==='history' ? 'bg-blue-50' : ''}`}><Icons.History active={activeTab==='history'}/></button>
                            <button onClick={()=>setActiveTab('summary')} className={`p-4 rounded-2xl transition-all ${activeTab==='summary' ? 'bg-blue-50' : ''}`}><Icons.Chart active={activeTab==='summary'}/></button>
                        </div>
                    </div>

                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<HealthTracker />);
    </script>
</body>
</html>
